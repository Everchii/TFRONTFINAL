<div class="reservations-listado">
  <h2>Mis Reservas</h2>

  <div class="controls">
    <button (click)="newReservation()" class="btn btn-success">+ Nueva Reserva</button>
    <button (click)="back()" class="btn btn-secondary">Volver</button>
  </div>

  <div class="filters">
    <h3>Filtros</h3>
    <div class="filter-row">
      <div class="filter-group">
        <label for="restaurantFilter">Restaurante:</label>
        <select
          id="restaurantFilter"
          [(ngModel)]="filterRestaurantId"
          (change)="onRestaurantChange()"
          class="filter-select"
        >
          <option value="">Todos</option>
          <option *ngFor="let r of restaurants" [value]="r.id">
            {{ r.nombre }}
          </option>
        </select>
      </div>

      <div class="filter-group">
        <label for="zoneFilter">Zona:</label>
        <select
          id="zoneFilter"
          [(ngModel)]="filterZoneId"
          (change)="onZoneChange()"
          class="filter-select"
        >
          <option value="">Todas</option>
          <option *ngFor="let z of zones" [value]="z.id">
            {{ z.nombre }}
          </option>
        </select>
      </div>

      <div class="filter-group">
        <label for="fechaFilter">Fecha:</label>
        <input
          id="fechaFilter"
          type="date"
          [(ngModel)]="filterFecha"
          (change)="onFechaChange()"
          class="filter-select"
        />
      </div>
    </div>
  </div>

  <div class="reservations-table">
    <h3>Reservas ({{ filteredReservations.length }})</h3>

    <div *ngIf="filteredReservations.length === 0" class="empty-state">
      <p>No hay reservas que coincidan con los filtros aplicados.</p>
    </div>

    <table *ngIf="filteredReservations.length > 0" class="table">
      <thead>
        <tr>
          <th>Restaurante</th>
          <th>Zona</th>
          <th>Fecha</th>
          <th>Hora</th>
          <th>Personas</th>
          <th>Mesa</th>
          <th>Nombre</th>
          <th>Tel√©fono</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let res of filteredReservations" class="table-row">
          <td>{{ getRestaurantName(res.restaurantId) }}</td>
          <td>{{ getZoneName(res.zoneId) }}</td>
          <td>{{ res.fecha }}</td>
          <td>{{ res.horas && res.horas.length > 0 ? (res.horas.join(', ')) : res.hora }}</td>
          <td>{{ res.cantidadPersonas }}</td>
          <td>{{ getMesaNumber(res.idMesaAsignada) }}</td>
          <td>{{ res.nombre }} {{ res.apellido }}</td>
          <td>{{ res.telefono }}</td>
          <td>
            <button
              (click)="deleteReservation(res.id)"
              class="btn btn-danger btn-small"
            >
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
